<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expérience 3D</title>

  <!-- Police Apex (remplacée ici par une proche : Azeret Mono) -->
  <link href="https://fonts.googleapis.com/css2?family=Azeret+Mono:wght@500&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-color: #00AFD7;
      --text-color: #fff;
      --font: 'Azeret Mono', monospace;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background-color: var(--bg-color);
      font-family: var(--font);
    }

    #renderCanvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }

    .label {
      position: absolute;
      color: var(--text-color);
      font-size: 22px;
      font-weight: 500;
      pointer-events: auto;
      z-index: 5;
      display: none;
      cursor: pointer;
      text-shadow: 1px 1px 4px #00000088;
      transform: translate(-50%, -50%);
    }

    #videoContainer {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      width: 50%;
      max-width: 800px;
      height: 30%;
      transform: translate(-50%, -50%);
      z-index: 10;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: transparent;
    }

    #videoContainer iframe {
      width: 100%;
      height: calc(100% - 40px);
      border: none;
    }

    #backButton {
      width: 100%;
      height: 40px;
      background: white;
      color: black;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    #backButton:hover {
      background: #e2e2e2;
    }

    /* Menu hamburger */
    .menu-button {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 99;
      width: 40px;
      height: 30px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      cursor: pointer;
    }

    .menu-button span {
      background: white;
      height: 4px;
      border-radius: 2px;
      transition: all 0.3s ease;
    }

    /* Menu overlay */
    .menu-overlay {
      position: fixed;
      top: 0;
      right: -100%;
      width: 300px;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      color: white;
      z-index: 98;
      padding: 60px 30px;
      transition: right 0.5s ease-in-out;
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .menu-overlay.open {
      right: 0;
    }

    .menu-item {
      display: flex;
      align-items: center;
      gap: 15px;
      text-decoration: none;
      color: white;
      font-size: 18px;
      transition: transform 0.3s ease, color 0.3s ease;
    }

    .menu-item:hover {
      transform: translateX(5px);
      color: var(--bg-color);
    }

    .menu-item svg {
      width: 24px;
      height: 24px;
      transition: transform 0.3s ease;
    }

    .menu-item:hover svg {
      transform: scale(1.2) rotate(10deg);
      fill: var(--bg-color);
    }
  </style>
</head>
<body>

  <!-- Labels -->
  <div id="label1" class="label">socleetoiletoque</div>
  <div id="label2" class="label">agenda</div>
  <div id="label3" class="label">computer</div>
  <div id="label4" class="label">coffre</div>
  <div id="label5" class="label">livres</div>

  <canvas id="renderCanvas"></canvas>

  <!-- Vidéo -->
  <div id="videoContainer">
    <iframe id="videoFrame" allow="autoplay" allowfullscreen></iframe>
    <button id="backButton">Retour à la scène 3D</button>
  </div>

  <!-- Menu bouton -->
  <div class="menu-button" onclick="toggleMenu()">
    <span></span><span></span><span></span>
  </div>

  <!-- Menu overlay -->
  <div class="menu-overlay" id="menu">
    <a href="https://www.youtube.com/watch?v=Jgcb7hjdgaU" class="menu-item" target="_blank">
      <svg viewBox="0 0 24 24" fill="white"><path d="M12 2L2 7l10 5 10-5-10-5zm0 18.18L2 15v2l10 5 10-5v-2l-10 5.18z"/></svg>
      Socle Étoile Toque
    </a>
    <a href="https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1" class="menu-item" target="_blank">
      <svg viewBox="0 0 24 24" fill="white"><path d="M19 3H5c-1.1 0-2 .9-2 2v14l4-4h12c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/></svg>
      Agenda
    </a>
    <a href="https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1" class="menu-item" target="_blank">
      <svg viewBox="0 0 24 24" fill="white"><path d="M4 5h16v14H4z"/></svg>
      Computer
    </a>
    <a href="https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1" class="menu-item" target="_blank">
      <svg viewBox="0 0 24 24" fill="white"><path d="M20 6H4v12h16V6z"/></svg>
      Coffre
    </a>
    <a href="https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1" class="menu-item" target="_blank">
      <svg viewBox="0 0 24 24" fill="white"><path d="M18 2H6c-1.1 0-2 .9-2 2v16l4-4h10c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>
      Livres
    </a>
  </div>

  <!-- Babylon.js -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylon.glTF2FileLoader.js"></script>

  <script>
    const canvas = document.getElementById("renderCanvas");
    const engine = new BABYLON.Engine(canvas, true);
    const scene = new BABYLON.Scene(engine);
    scene.clearColor = new BABYLON.Color3.FromHexString("#00AFD7");

    const camera = new BABYLON.ArcRotateCamera("camera", Math.PI / 2, Math.PI / 2.5, 4, BABYLON.Vector3.Zero(), scene);
    camera.attachControl(canvas, true);
    const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);

    const labels = [
      { id: 'label1', file: 'socleetoiletoque.glb', offset: { x: 0, y: 0 } },
      { id: 'label2', file: 'agenda.glb', offset: { x: 50, y: -20 } }, // Ajusté
      { id: 'label3', file: 'computer.glb', offset: { x: -30, y: 30 } },
      { id: 'label4', file: 'coffre.glb', offset: { x: 0, y: 0 } },
      { id: 'label5', file: 'livres.glb', offset: { x: 0, y: 0 } }
    ];

    const videoLinks = {
      label1: "https://www.youtube.com/watch?v=Jgcb7hjdgaU",
      label2: "https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1",
      label3: "https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1",
      label4: "https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1",
      label5: "https://www.youtube.com/embed/lUU1G-6klpI?autoplay=1"
    };

    const videoContainer = document.getElementById("videoContainer");
    const videoFrame = document.getElementById("videoFrame");

    labels.forEach(({ id, file, offset }) => {
      const label = document.getElementById(id);
      BABYLON.SceneLoader.Append("", file, scene, function (scene) {
        const mesh = scene.meshes[scene.meshes.length - 1];
        scene.registerAfterRender(() => {
          if (!mesh) return;
          const pos = mesh.getBoundingInfo().boundingSphere.centerWorld;
          const proj = BABYLON.Vector3.Project(pos, BABYLON.Matrix.Identity(), scene.getTransformMatrix(), camera.viewport.toGlobal(engine.getRenderWidth(), engine.getRenderHeight()));
          if (proj.z >= 0 && proj.z <= 1) {
            label.style.left = (proj.x + offset.x) + "px";
            label.style.top = (proj.y + offset.y) + "px";
            label.style.display = "block";
          } else {
            label.style.display = "none";
          }
        });
        label.addEventListener("click", () => {
          videoContainer.style.display = "flex";
          videoFrame.src = videoLinks[id];
        });
      });
    });

    document.getElementById("backButton").addEventListener("click", () => {
      videoContainer.style.display = "none";
      videoFrame.src = "";
    });

    window.addEventListener("resize", () => engine.resize());
    engine.runRenderLoop(() => scene.render());

    function toggleMenu() {
      const menu = document.getElementById("menu");
      menu.classList.toggle("open");
    }
  </script>
</body>
</html>
